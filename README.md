# AdPlacementService     
[![.NET](https://github.com/vertigra/AdPlacementService/actions/workflows/dotnet.yml/badge.svg)](https://github.com/vertigra/AdPlacementService/actions/workflows/dotnet.yml)
![GitHub License](https://img.shields.io/github/license/vertigra/AdPlacementService)

Веб-сервис для подбора рекламных площадок по географическим локациям.

## Описание

Этот сервис позволяет рекламодателям находить подходящие рекламные площадки для размещения рекламы в конкретных регионах. Сервис загружает данные о рекламных площадках из текстового файла и предоставляет API для поиска площадок по заданной локации.

## Функциональность

### Основные возможности:
- Загрузка данных о рекламных площадках из текстового файла
- Поиск рекламных площадок для заданной локации
- Хранение данных в оперативной памяти (in-memory)
- REST API интерфейс
- Поддержка иерархических локаций

### Пример данных:
```
Яндекс.Директ:/ru
Ревдинский рабочий:/ru/svrd/revda,/ru/svrd/pervik
Газета уральских москвичей:/ru/msk,/ru/permobl,/ru/chelobl
Крутая реклама:/ru/svrd
```

### Логика поиска:
- Локации вложены: `/ru/svrd/revda` вложена в `/ru/svrd`, `/ru/svrd` вложена в `/ru`
- Рекламная площадка действует во всех указанных локациях
- Чем меньше вложенность локации, тем глобальнее действует рекламная площадка

### Примеры поиска:
- Для локации `/ru/msk` подходят: Газета уральских москвичей и Яндекс.Директ
- Для локации `/ru/svrd` подходят: Яндекс.Директ и Крутая реклама
- Для локации `/ru/svrd/revda` подходят: Яндекс.Директ, Ревдинский рабочий и Крутая реклама
- Для локации `/ru` подходит только: Яндекс.Директ

## Технологии

- **.NET 9**
- **ASP.NET Core Minimal API**
- **C# 10**
- **xUnit** (для тестирования)

## Установка и запуск

### Требования:
- .NET 9 SDK
- Git (опционально)

### Запуск из исходного кода:

```bash
# Клонирование репозитория
git clone https://github.com/vertigra/AdPlacementService
cd AdPlacementService

# Запуск приложения
dotnet run
```

## API Endpoints

### 1. Загрузка данных
```
POST /api/load
Content-Type: text/plain

Тело запроса: текстовый файл с данными о рекламных площадках
```

**Пример:**
```bash
curl -X POST "http://localhost:5000/api/load" \
     -H "Content-Type: text/plain; charset=utf-8" \
     --data-binary @data.txt
```

### 2. Поиск рекламных площадок
```
GET /api/search/{location}
```

**Примеры:**
```bash
# Поиск для Москвы
curl -X GET "http://localhost:5000/api/search/ru/msk"

# Поиск для Свердловска
curl -X GET "http://localhost:5000/api/search/ru/svrd"
```

## Формат данных

### Входной файл:
```
Название площадки:локация1,локация2,локация3
```

### Пример:
```
Яндекс.Директ:/ru
Ревдинский рабочий:/ru/svrd/revda,/ru/svrd/pervik
Газета уральских москвичей:/ru/msk,/ru/permobl,/ru/chelobl
Крутая реклама:/ru/svrd
```

## Тестирование

### Запуск тестов:
```bash
dotnet test
```

## Производительность

- **Хранение данных**: В оперативной памяти для максимальной скорости доступа
- **Операция загрузки**: Выполняется редко, может занимать больше времени
- **Операция поиска**: Оптимизирована для быстрого выполнения
- **Алгоритм поиска**: Использует `StartsWith` для проверки иерархии локаций

## Безопасность

- Сервис не ломается от некорректных входных данных
- Все методы API имеют обработку исключений

## Ограничения

- Данные хранятся только в оперативной памяти (при перезапуске теряются)
- Нет аутентификации/авторизации
- Нет ограничений на размер загружаемых данных
- Нет логирования в файл

## Разработка

### Структура проекта:
```
AdPlacementService/
├── Program.cs              # Точка входа и основная логика API
├── AdPlacementService.csproj # Файл проекта
├── Models/
│   └── AdPlatform.cs       # Модель рекламной площадки
AdPlacementService.Tests/
└── AdPlacementIntegrationTests.cs # тесты
```

## Пример использования

1. **Создайте файл данных** `data.txt`:
```
Яндекс.Директ:/ru
Ревдинский рабочий:/ru/svrd/revda,/ru/svrd/pervik
Газета уральских москвичей:/ru/msk,/ru/permobl,/ru/chelobl
Крутая реклама:/ru/svrd
```

2. **Загрузите данные**:
```bash
curl -X POST "https://localhost:5001/api/load" \
     -H "Content-Type: text/plain; charset=utf-8" \
     --data-binary @data.txt
```

3. **Выполните поиск**:
```bash
curl -X GET "https://localhost:5001/api/search/ru/msk"
# Результат: ["Яндекс.Директ", "Газета уральских москвичей"]
```

## Лицензия

MIT License
